### **Specification: Topic Retrieval Console Application**
(This specification was generated by AI Studio based on the prompt in prompt_gen_topicretrieval_spec.md).

#### **1. Introduction**

This document outlines the specification for a console application designed to retrieve and catalog university course topics from the BME Department of Automation and Applied Informatics website. The application will scrape data from various predefined web pages, extract detailed information for each topic, and store the consolidated data in a structured JSON file for further use.

#### **2. Data Sources**

The application will retrieve data from the following source URLs, which are categorized by education level, curriculum, and project type.

*   **BSc Level**
    *   IT Engineer (Mérnök Informatikus)
        *   Project Laboratory: `https://www.aut.bme.hu/Education/BScInfo/Onlab`
        *   Thesis Project: `https://www.aut.bme.hu/Education/BScInfo/Szakdolgozat`
    *   Electrical Engineer (Villamosmérnök)
        *   Project Laboratory: `https://www.aut.bme.hu/Education/BScVillany/Onlab`
        *   Thesis Project: `https://www.aut.bme.hu/Education/BScVillany/Szakdolgozat`
    *   Mechatronics Engineer (Mechatronikai mérnök)
        *   Thesis Project: `https://www.aut.bme.hu/Education/BScMechatronika/Szakdolgozat`
*   **MSc Level**
    *   IT Engineer (Mérnök Informatikus)
        *   Project Laboratory: `https://www.aut.bme.hu/Education/MScInfo/Onlab`
        *   Thesis Project: `https://www.aut.bme.hu/Education/MScInfo/Diploma`
    *   Electrical Engineer (Villamosmérnök)
        *   Project Laboratory: `https://www.aut.bme.hu/Education/MScVillany/Onlab`
        *   Thesis Project: `https://www.aut.bme.hu/Education/MScVillany/Diploma`
    *   Mechatronics Engineer (Mechatronikai mérnök)
        *   Project Task: `https://www.aut.bme.hu/Education/MScMechatronika/Onlab`
        *   Thesis Project: `https://www.aut.bme.hu/Education/MScMechatronika/Diploma`

#### **3. Output Data Schema**

The application will generate a single JSON file containing a list of topic objects. Each object will adhere to the following structure:

```json
[
  {
    "title": "Topic Title",
    "url": "https://www.aut.bme.hu/Task/...",
    "is_external": true,
    "external_partner": "Name of Company or null",
    "student_limit": 2,
    "advisors": [
      "Advisor Name 1",
      "Advisor Name 2"
    ],
    "courses": [
      {
        "course_code": "BMEVIAU...",
        "course_name": "Course Name as seen in dropdown"
      }
    ],
    "source_category_url": "https://www.aut.bme.hu/Education/BScInfo/Onlab"
  }
]
```

#### **4. Application Logic and Scraping Process**

The application will perform the following steps:

1.  **Initialization**: Create an empty master list to hold the final topic data objects.

2.  **Iterate Through Category URLs**: The application will loop through each URL listed in Section 2. For each URL:
    a.  **Fetch Category Page**: Download the content of the category page using HTTP requests.
    b.  **Extract Topic Links and Course Information**: Under the heading **"Kiírt témák"** (Announced Topics), parse all topic entries. For each topic entry:
        i.  The topic title is the text of the main `<a>` tag link.
        ii. The `href` attribute is the topic's details page `url`.
        iii. **Extract Course Codes from Category Page**: On the category page, each topic entry contains course code information that appears as text (e.g., "BMEVIAU...", "BMEVIEE...", etc.). Parse all course codes that appear in the topic's section on the category page.

3.  **Process Each Topic Detail Page**: For every topic URL extracted in the previous step:
    a.  **Fetch Topic Page**: Download the content of the topic detail page using HTTP requests (no browser automation needed).
    b.  **Extract Core Information**:
        *   **External Partner**: Check for the text **"Külső partner:"**. If it exists, set `is_external` to `true` and store the subsequent text as the `external_partner`. If not, set `is_external` to `false` and `external_partner` to `null`.
        *   **Student Limit**: Find the text **"Maximális létszám:"** and parse the integer value from the following text (e.g., from "2 fő").
        *   **Advisors**: Locate the **"Konzulensek"** section and extract the list of names.
    c.  **Combine Course Data**: Use the course codes extracted from the category page (step 2.iii) to populate the `courses` array. For each course code:
        *   Store the course code as `course_code` (already in full "BMEVIAU..." format).
        *   Use the course code as `course_name` or extract the full course name if available on the detail page.
    d.  **Aggregate Data**: Assemble all extracted data (`title`, `url`, `is_external`, etc.) into a JSON object matching the schema in Section 3. Add the `source_category_url` to indicate where the topic was found.
    e.  **Append to Master List**: Add the newly created topic object to the master list.

4.  **Final Output**: After iterating through all topics from all category pages, serialize the master list into a well-formatted JSON string and save it to a file named `topics.json`.

#### **5. Technical Requirements**

*   **Language**: Python
*   **Libraries**:
    *   **HTML Parsing**: **Beautiful Soup** and **lxml** for parsing static HTML content from both category and detail pages.
    *   **HTTP Client**: **requests** for fetching web page content.
    *   **JSON Processing**: Built-in `json` module for output serialization.
    *   **Regular Expressions**: `re` module for parsing course codes and other text patterns.
*   **Execution Environment**: A console environment with Python and the required libraries installed. **No browser automation or WebDriver required** since all data can be extracted from static HTML content.

#### **6. Error Handling**

The application should be robust and handle potential issues gracefully:

*   **HTTP Errors**: Catch exceptions for network issues or non-existent pages (e.g., 404 Not Found).
*   **Missing Elements**: If a required element (e.g., "Kiírt témák" or "Konzulensek") is not found on a page, the application should log a warning with the relevant URL and continue processing other items.
*   **Data Parsing Errors**: If a value cannot be parsed as expected (e.g., the student limit is not a number), it should be logged and defaulted to a `null` or appropriate default value.
*   **Course Code Extraction**: If no course codes are found on the category page for a topic, the `courses` array should be empty `[]` rather than causing an error.

#### **7. Performance Benefits**

This simplified approach offers several advantages:

*   **Faster Processing**: No browser automation overhead - direct HTTP requests are much faster.
*   **No Authentication Required**: Since course codes are visible on category pages, no user login is needed.
*   **Simpler Dependencies**: Eliminates Selenium, WebDriver, and browser dependencies.
*   **More Reliable**: Static HTML parsing is more stable than dynamic browser automation.
*   **Resource Efficient**: Lower memory and CPU usage compared to browser automation.

